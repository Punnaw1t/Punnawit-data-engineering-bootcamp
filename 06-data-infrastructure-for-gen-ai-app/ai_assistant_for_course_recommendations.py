import json
import os

import pandas as pd
from google import genai
from google.genai import types
from google.cloud import bigquery
from google.oauth2 import service_account


GCP_PROJECT_ID = "poetic-fact-462916-g2"
DATASET_ID = "deb_bootcamp"
TABLE_ID = "my_course_embeddings"
KEYFILE = "/workspaces/data-engineering-bootcamp/06-data-infrastructure-for-gen-ai-app/deb-loading-data-to-bq-secured.json"
# api_key = os.environ.get("GEMINI_API_KEY")
GEMINI_API_KEY = "AIzaSyCRbdOQqakgNCsfq-MZciuxAwR4au4-iBA"


def get_embedding(client, model: str = "gemini-embedding-exp-03-07", text: str = ""):
    result = client.models.embed_content(
        model=model,
        contents=text,
    )
    return result.embeddings[0]


def ask_gemini(client, model: str = "gemini-2.0-flash-001", prompt: str = ""):
    response = client.models.generate_content(
        model=model,
        contents=prompt,
        config=types.GenerateContentConfig(
            system_instruction=[
                "You are a course recommender.",
                "Your mission is to recommend courses for people who want to upskill and switch careers."
            ]
        ),
    )
    return response.text


def load_data_to_bigquery(client, df):
    schema = [
        bigquery.SchemaField("text", "STRING"),
        bigquery.SchemaField("embedding", "FLOAT64", mode="REPEATED"),
    ]
    job_config = bigquery.LoadJobConfig(
        schema=schema,
        write_disposition="WRITE_TRUNCATE"
    )
    table_id = f"{GCP_PROJECT_ID}.{DATASET_ID}.{TABLE_ID}"
    load_job = client.load_table_from_dataframe(df, table_id, job_config=job_config)
    load_job.result()

    print(f"Loaded {load_job.output_rows} rows into {table_id}")


def search_similar_texts(client, vec):
    query = f"""
        SELECT
            base.text,
            distance
        FROM
        VECTOR_SEARCH(
            TABLE `{DATASET_ID}.{TABLE_ID}`,
            'embedding',
            (select {vec} as embedding),
            top_k => 3,
            distance_type => 'EUCLIDEAN'
        )
    """

    # Run the query
    query_job = client.query(query)

    # Get the results
    results = query_job.result()

    # Print the results
    similar_texts = []
    for row in results:
        similar_texts.append(row.text)
        print(row.text)
        print(row.distance)

    return similar_texts


# Add more course data here
df = pd.DataFrame(data={
    "text": [
       "คอร์ส Probability for Data Science - ความน่าจะเป็นถูกนำมาใช้ในงาน Data Science ในงานด้านวิเคราะห์ข้อมูลและสร้างโมเดล เพื่อทำให้มั่นใจได้ว่าข้อมูลที่ได้มา มันมีความหมาย และมี Insight ถ้าคุณยังต้องนำข้อมูลไปทำโมเดลต่อ ไม่ว่าจะเป็นโมเดล Machine Learning หรือการทำนาย ล้วนก็มีงานใช้งานความน่าจะเป็นในการสร้างโมเดล ซึ่งคุณไม่มีทางจะหลีกเลี่ยงสิ่งนี้ได้ เพราะถ้าคุณไม่เข้าใจความน่าจะเป็นอย่างแท้จริง คุณอาจกำลังใช้โมเดล Machine Learning ที่จำลองสถานการณ์ผิดไปจากโจทย์ที่กำลังเผชิญอยู่ก็ได้! ข่าวดีคือ คุณไม่จำเป็นต้องเป็นอัจฉริยะด้านคณิตศาสตร์ก็สามารถเข้าใจความน่าจะเป็นได้!",
       "คอร์ส Data Pipelines with Airflow - คอร์สนี้เป็นคอร์สออนไลน์ที่ออกแบบมาเพื่อสาย Data Engineer หรือผู้ที่สนใจวางระบบจัดการข้อมูลอัตโนมัติ เรียนรู้การสร้าง End‑to‑End Data Pipelines ด้วย Apache Airflow ตั้งแต่การอ่านข้อมูล (Extract) การทำความสะอาด (Clean) การปรับโครงสร้าง (Transform) และการโหลดข้อมูลเข้า Data Lake/Data Warehouse (Load) โดยอัตโนมัติ รองรับการจัดการ Big Data ได้อย่างมีประสิทธิภาพ ภายในเวลา 4–5 ชั่วโมง มีแบบฝึกหัดและโปรเจกต์จริง (เช่น pipeline ข้อมูล cryptocurrency) หลังเรียนจบจะได้รับประกาศนียบัตร พร้อมพื้นฐานที่จำเป็น เช่น SQL และ Python",
       "คอร์ส Agile Essentials จาก Skooldio เป็นคอร์สออนไลน์ความยาวประมาณ 3 ชั่วโมง ที่ออกแบบมาเพื่อปูพื้นฐานความเข้าใจ Agile ตั้งแต่แนวคิดและทัศนคติ (Agile Mindset), วิธีบริหารโปรเจกต์แบบ Agile (Agile Project Management), การทำงานเป็นทีมข้ามสายงาน (Cross-functional Team), การใช้ Framework ยอดนิยมอย่าง Scrum และ Kanban ไปจนถึงวิธีเริ่มต้นนำไปใช้จริงในองค์กร โดยผู้สอนคือ ดร. วิโรจน์ จิรพัฒนกุล อดีต Data Scientist จาก Facebook ผู้มีประสบการณ์จริง เนื้อหาครอบคลุมทั้งทฤษฎีและกรณีศึกษา เพื่อให้ผู้เรียนเข้าใจหลักการและสามารถนำไปประยุกต์ใช้ได้ทันที เหมาะสำหรับผู้บริหาร หัวหน้าทีม HR หรือผู้ที่อยากพัฒนาการทำงานให้ยืดหยุ่นและตอบโจทย์ความต้องการของลูกค้าได้รวดเร็วขึ้น",
       "คอร์ส Project Management Essentials จาก Skooldio สอนการบริหารโปรเจกต์อย่างเป็นระบบ ครอบคลุมทุกขั้นตอนตั้งแต่เริ่มต้น วางแผน ดำเนินงาน ติดตามผล จนถึงปิดโครงการ พร้อมเครื่องมือและเทมเพลตใช้งานจริง เช่น Gantt Chart, WBS, Risk Register เหมาะสำหรับผู้เริ่มต้นหรือคนที่ต้องดูแลโปรเจกต์ในสายงานต่างๆ และยังมีสอนการใช้ AI ช่วยบริหารงานด้วย",
       "คอร์ส Exploratory Data Analysis with Excel จาก Skooldio เป็นคอร์สออนไลน์ที่ออกแบบมาเพื่อสอนการวิเคราะห์ข้อมูลเบื้องต้น (EDA) โดยใช้ Microsoft Excel เหมาะสำหรับผู้เริ่มต้นที่ไม่มีพื้นฐานมาก่อน โดยผู้เรียนจะได้เรียนรู้ตั้งแต่การจัดการและทำความสะอาดข้อมูล การใช้สูตรต่าง ๆ ใน Excel การสร้างภาพข้อมูล (Data Visualization) ไปจนถึงการวิเคราะห์เชิงสถิติ เพื่อค้นหา Insight ที่สามารถนำไปใช้ในการตัดสินใจทางธุรกิจได้จริง คอร์สนี้เน้นการเรียนรู้ผ่านการลงมือทำจริง มีแบบฝึกหัดและโปรเจกต์จากข้อมูลจริง พร้อมรับประกาศนียบัตรเมื่อเรียนจบ ใช้เวลาเรียนประมาณ 10–12 ชั่วโมง และเหมาะกับทั้งนักศึกษา พนักงานสาย Business, Marketing, Product, Analyst รวมถึงเจ้าของกิจการที่ต้องการใช้ Excel เพื่อวิเคราะห์ข้อมูลอย่างมีประสิทธิภาพ",
       "คอร์ส Go-to-Market Strategies - จาก Skooldio เหมาะสำหรับผู้ที่ต้องการวางแผนการนำสินค้า/บริการเข้าสู่ตลาดอย่างมีประสิทธิภาพ โดยไม่จำเป็นต้องมีพื้นฐานมาก่อน เรียนรู้ผ่านกรณีศึกษาและเครื่องมือที่ใช้งานได้จริง เนื้อหาครอบคลุมตั้งแต่การเข้าใจตลาด การกำหนดกลุ่มเป้าหมาย การเลือกช่องทางจัดจำหน่าย ไปจนถึงการวัดผลด้วย KPI ชัดเจน",
       "คอร์ส Intro to Product Management จาก Skooldio เป็นคอร์สออนไลน์สั้น (~2–3 ชั่วโมง) ราคา 990 บาท ที่ออกแบบมาเพื่อปูพื้นฐานสายงาน Product Manager อย่างกระชับ เข้าใจบทบาท หน้าที่ และกระบวนการพัฒนาดิจิทัลโปรดักต์ตั้งแต่ต้นจนจบ พร้อมตัวอย่างเคสจริง ช่วยให้ผู้เรียนเข้าใจการทำงานร่วมกับทีมธุรกิจ ดีไซน์ และเทคโนโลยี เหมาะสำหรับผู้เริ่มต้นหรือผู้ที่สนใจเปลี่ยนสายงานมาสู่สาย PM โดยไม่ต้องมีพื้นฐานมาก่อน",
       "คอร์ส Exploratory Data Analysis with Google Sheets ของ Skooldio เป็นหลักสูตรออนไลน์สำหรับผู้เริ่มต้นถึงระดับกลางที่ต้องการเรียนรู้การวิเคราะห์ข้อมูลเบื้องต้นโดยใช้ Google Sheets โดยเน้นการเตรียมข้อมูล การวิเคราะห์ด้วยฟังก์ชันพื้นฐานและ Pivot Table รวมถึงการสร้างกราฟเพื่อสื่อสารข้อมูลอย่างมีประสิทธิภาพ ผู้สอนคือ ดร.วิโรจน์ จิรพัฒนกุล อดีต Data Scientist จาก Facebook ที่มีประสบการณ์ตรง ผู้เรียนจะได้ทำแบบฝึกหัดพร้อมรับใบประกาศนียบัตรหลังจบคอร์ส เหมาะสำหรับผู้ที่ต้องการพัฒนาทักษะวิเคราะห์ข้อมูลเพื่อใช้ในงานหรือธุรกิจ และเป็นจุดเริ่มต้นที่ดีสำหรับผู้ไม่มีพื้นฐานมาก่อน โดยระยะเวลาคอร์สประมาณ 6–8 ชั่วโมงเรียนออนไลน์ผ่านวิดีโอและ live coding",
       "คอร์ส Data Storytelling with Infographics ของ Skooldio (โดยทีม Punch Up) เน้นเสริมทักษะสื่อสารข้อมูลผ่านกราฟิกอย่างสร้างสรรค์ในเวลา 2–3 ชั่วโมง เหมาะกับผู้ที่ไม่มีพื้นฐานมาก โดยผู้เรียนจะได้เรียนวิธีวิเคราะห์ข้อมูล สังเกตกลุ่มเป้าหมาย และจัดองค์ประกอบกราฟิกตามโมเดล SMAC (Sender, Message, Audience, Channel) พร้อม 30 วิดีโอบทเรียน ผ่านกรณีศึกษาและแบบฝึกหัดจริง เพื่อเปลี่ยนข้อมูลเชิงตัวเลขให้เป็นนิยามผ่าน infographic ที่สวยงาม เข้าใจง่าย และโน้มน้าวใจผู้ฟังครบกระบวนการ พร้อมรับประกาศนียบัตรหลังเรียนจบ โดยเน้นท่าฝึกที่ใช้กล้ามเนื้อหลายมัด (compound exercises) เช่น squat, deadlift, bench press ร่วมกับการรับประทานโปรตีนให้เพียงพอ (ประมาณ 1.6–2.2 กรัมต่อน้ำหนักตัว 1 กิโลกรัมต่อวัน) พักผ่อนให้เพียงพอ ",
       "คอร์ส Presentation Design Principles มุ่งเน้นการสอนหลักการออกแบบสไลด์นำเสนอให้มีประสิทธิภาพและเข้าใจง่าย เพื่อช่วยให้ผู้ฟังเข้าใจวัตถุประสงค์การสื่อสาร และสร้างโอกาสที่ดีในอาชีพ โดยเน้นการสร้างสรรค์การนำเสนอที่น่าสนใจ ดึงดูดอารมณ์ร่วม และสามารถแปลงข้อมูลที่ซับซ้อนให้เป็นรูปภาพหรือกราฟิกที่สวยงาม ชัดเจน เหมือนกับการนำเสนอระดับโลกจากบุคคลเช่น Steve Jobs หรือ TED Talks ซึ่งคุณจะได้เรียนรู้เทคนิคการเลือกใช้สี รูปภาพ ฟอนต์ และการจัดวางจากคุณออย-ปรมัตถ์ หาญภิรมย์ เจ้าของแฟนเพจ Oil-PresentX ทำให้คุณสามารถสร้างสรรค์สไลด์ที่เสริมสร้างความมั่นใจและนำเสนอเรื่องราวได้อย่างน่าประทับใจยิ่งขึ้น ไม่ว่าคุณจะเป็นคนทำงาน นักเรียน นักศึกษา หรือบุคคลทั่วไปที่ต้องการพัฒนาทักษะนี้ ขอเพียงมีพื้นฐานการใช้โปรแกรมนำเสนอมาก่อนก็สามารถเรียนได้",
       "การเขียนโปรแกรมเป็นทักษะสำคัญในยุคปัจจุบัน โดยภาษา Python เป็นหนึ่งในภาษายอดนิยมที่เหมาะสำหรับผู้เริ่มต้น เพราะใช้งานง่าย ยืดหยุ่น และประยุกต์ใช้ได้หลากหลาย ทั้งด้านการพัฒนาเว็บ แอปพลิเคชัน งานด้านข้อมูล วิทยาศาสตร์ข้อมูล และปัญญาประดิษฐ์ คอร์ส Python Programming Foundations จึงถูกออกแบบมาเพื่อสอน Python ด้วยภาษาที่เข้าใจง่าย แม้ไม่มีพื้นฐานมาก่อน โดยเน้นความเข้าใจแนวคิดการเขียนโปรแกรม เช่น ประเภทข้อมูล โครงสร้างข้อมูล คำสั่งควบคุม ฟังก์ชัน และการลงมือทำจริง เหมาะกับทั้งผู้สนใจทั่วไป นักเรียน นักศึกษา นักวิเคราะห์ข้อมูล หรือคนทำงานที่อยากย้ายสายมาใช้ Python เพื่อเพิ่มทักษะ เมื่อจบคอร์สจะสามารถเขียน Python เบื้องต้นได้ และต่อยอดสู่ระดับสูงขึ้นได้อย่างมั่นใจ.",
       "คอร์ส Effective Data Storytelling ของ Skooldio เป็นคอร์สออนไลน์ความยาวประมาณ 4–5 ชั่วโมง (ราคา 2,990 บาท) ที่ออกแบบมาเพื่อเปลี่ยนข้อมูลดิบให้กลายเป็นเรื่องราวที่กระชับ, น่าสนใจ และโน้มน้าวใจผู้ฟังได้อย่างมีประสิทธิภาพ โดยไม่ต้องมีพื้นฐานมาก่อน คุณจะได้เรียนตั้งแต่หลักการปิดช่องว่างการสื่อสาร, ทำความเข้าใจผู้ฟัง, เลือกกราฟให้เหมาะสมกับแต่ละจุดประสงค์ เช่น เปรียบเทียบ, แสดงความสัมพันธ์, กระจายตัว หรือส่วนประกอบ ไปจนถึงการจัดโครงเรื่องแบบ SCQ (Situation, Complication, Question) และตั้งหัวเรื่อง (Headline) ให้ชัดเจน เพื่อให้สามารถสื่อสารประเด็นสำคัญผ่านภาพและเรื่องเล่าได้ทันทีหลังเรียนจบ พร้อมรับประกาศนียบัตรเมื่อผ่านหลักสูตร",
       "ไม่ว่าจะเริ่มใช้ หรือ ยังไม่เคยใช้มาก่อน เนื้อหาในคอร์สนี้คือสิ่งที่คุณ ‘ต้องรู้’ เกี่ยวกับ Generative AI หากไม่อยากตกขบวน ด้วยเนื้อหาด้าน Generative ที่ออกแบบและสอนโดยอย่าง ดร. ต้า - วิโรจน์ จิรพัฒนกุล Google Developer Expert ด้าน Machine Learning ด้วยเนื้อหาที่ช่วยให้คุณ...เข้าใจ GenAI มากขึ้น ตั้งแต่ฝึกลงมือใช้ AI ช่วยในกว่า 10 Use Cases ที่คนทำงานมักหนีไม่พ้น เพื่อให้แน่ใจว่าคุณจะสามารถนำความรู้เรื่อง Generative AI ไปต่อยอดใช้ได้จริงใช้ GenAI ให้เหมาะสม ฝึกใช้งาน AI Tools อย่าง ChatGPT โดยใช้วิธีการเขียน Prompt อย่างมีโครงสร้างและเป็นระบบ ผ่านหลักการสากลที่ได้รับการยอมรับในงานวิจัย ว่าได้ผลลัพธ์ที่ดีกว่าจริงต่อยอดไปสู่ Use Cases ไม่รู้จบ ฝึกลงมือใช้ AI ช่วยในกว่า 10 Use Cases ที่คนทำงานมักหนีไม่พ้น เพื่อให้แน่ใจได้ว่าคุณจะสามารถนำความรู้เรื่อง Generative AI ไปต่อยอดใช้ได้จริงหากมองหาเพียงการท่องจำ Prompt คอร์สนี้อาจไม่เหมาะสำหรับคุณเนื้อหาทั้งหมดนี้สอนผ่านคอร์สออนไลน์ที่ ผสมผสานการบรรยายเนื้อหาภาคทฤษฎีที่สำคัญ ไปกับภาคปฏิบัติ ด้วย Demo ที่อาจารย์ผู้สอนจะสาธิตการใช้งานให้คุณเข้าใจวิธีการทำงานอย่างถ่องแท้ พร้อมกับแบบฝึกหัดต่าง ๆ ในบทเรียน ให้คุณได้ออกแบบ Prompt และลองใช้งานด้วยตนเองหากคุณยังไม่แน่ใจว่า…AI/ LLMs/ ML ต่างกันอย่างไร?ChatGPT เริ่มใช้อย่างไร?ควรเขียน Prompt อย่างไรให้ได้ผลลัพธ์ดีที่สุดUse Cases แบบไหนที่ AI ทำได้ดีบ้าง?เทรนด์ AI ตอนน้ีเป็นอย่างไร?การเรียนคอร์สนี้จะเป็น ‘ก้าวสำคัญ’ ที่ช่วยให้คุณพัฒนาทักษะการใช้ Generative AI ที่ไม่ใช่แค่เทรนด์ระยะสั้น แต่จะเป็นหนึ่งในเทคโนโลยีที่พลิกวิธีการทำงานของเราอย่างมีนัยยะสำคัญ และสร้าง Impact มหาศาล",
       "เพราะทุกคนล้วนต้องการใช้งาน Application หรือ Website ที่ใช้งาน ‘ง่าย’ ‘ไม่ยุ่งยาก’ ‘ลดการคิด’ และสิ่งที่จะช่วยให้การออกแบบ Digital Products นั้นสามารถสร้าง User Experience ให้ใช้งานง่ายได้นั้นคือ การที่ผู้ออกแบบเข้าใจในหลักการออกแบบเพื่อให้เกิดความใช้งานง่าย (Usability) ซึ่งเป็นการออกแบบเพื่อผู้ใช้งานอย่างแท้จริง",
       "ภายในคอร์ส Usability Design and Psychology for Digital Products คุณจะได้รู้จักกับคำว่า Usability ตั้งแต่เริ่มต้นว่าคำนี้คืออะไร เกี่ยวข้องกับ Digital Products อย่างไร กฎที่ควรรู้เกี่ยวกับ Usability และเทคนิคจิตวิทยามากมายที่มาช่วยด้านการออกแบบ UX/UI เพื่อให้เกิดความใช้งานง่ายมีอะไรบ้าง พร้อมวิธีการวิเคราะห์ Digital Products ว่าใช้งานได้ ‘ง่าย’ จริงไหม",
       "คอร์ส UI Fundamentals - เป็นหลักสูตรที่ออกแบบมาเพื่อปูพื้นฐานด้านการออกแบบส่วนติดต่อผู้ใช้ (UI) อย่างเป็นระบบ เหมาะสำหรับผู้เริ่มต้นและผู้ที่ต้องการยกระดับทักษะการออกแบบให้มีเหตุผลรองรับ ครอบคลุมหลักการสำคัญ การออกแบบบนหลากหลายแพลตฟอร์ม ทั้ง Web, iOS และ Android ถ่ายทอดโดยผู้เชี่ยวชาญจากวงการ พร้อมกรณีศึกษาจริงและแบบฝึกปฏิบัติ เพื่อให้สามารถนำความรู้ไปประยุกต์ใช้ได้อย่างมืออาชีพ",
       "คอร์ส Introduction to Docker - เหมาะสำหรับ Developer, System/Infrastructure Engineer หรือใครที่สนใจเริ่มใช้ Docker โดยจะเริ่มตั้งแต่แนวคิดพื้นฐานเปรียบเทียบ Virtual Machine กับ Container, หลักการ Build–Ship–Run, คำสั่งพื้นฐานของ Docker, การติดตั้ง, การรัน Container และการจัดการ registry แล้วพัฒนาไปจนถึงการสร้าง Application จริงบน Container และใช้งานด้วย Docker Compose สุดท้ายผู้เรียนจะได้รับประกาศนียบัตรหลังเรียนจบ พร้อมสอบถามข้อสงสัยผ่าน Forum ได้",
       "คอร์สออนไลน์ DevSecOps Transformation & Technologies - Skooldio ขอเสนอคอร์สออนไลน์ DevSecOps Transformation & Technologies ราคา 2,990 บาท ใช้เวลาเรียน 6-7 ชั่วโมง ไม่จำเป็นต้องมีพื้นฐานมาก่อน ผู้เรียนจะได้รับประกาศนียบัตรเมื่อเรียนจบ และสามารถสอบถามข้อสงสัยใน Forum ได้ | เนื้อหาคอร์สครอบคลุม: | 1. พื้นฐาน: DevOps และ DevSecOps, ความสามารถของ DevSecOps ที่เหนือกว่า DevOps ในด้านความเร็วและความปลอดภัย, ความเกี่ยวข้องกับ Agile, Flow และ Component ต่างๆ ของ DevSecOps |  2.เทคโนโลยี: Cloud, Docker, Kubernetes, Version Control, CI/CD, Infrastructure as Code (Ansible, Terraform) | 3. ความปลอดภัยและการทำงานอัตโนมัติ: Security และการทำ Automation DevSecOps flow | 4.การนำไปใช้ในองค์กร: การสร้าง roadmap, การออกแบบ policy และ process, การบริหารจัดการทีมและการพัฒนาทักษะบุคลากร คอร์สนี้เหมาะสำหรับผู้ที่ทำ DevOps อยู่แล้ว องค์กรที่ต้องการเริ่มต้นทำ DevOps/DevSecOps และผู้บริหารองค์กรที่ต้องการทำความเข้าใจแนวคิดนี้ผู้สอนคือ จิรายุส นิ่มแสง ผู้เป็น Certified Kubernetes Administrator (CKA) และ Certified Kubernetes Security Specialist (CKS) คนแรกของประเทศไทย นอกจากนี้ยังมีแพ็กเกจที่รวมคอร์สอื่นๆ เช่น Introduction to Docker และ Kubernetes Mastery เพื่อให้สามารถเริ่มต้นทำ DevSecOps ในองค์กรได้อย่างครบวงจร",
       "คอร์สออนไลน์ Building Hybrid Applications with Flutter สอนการพัฒนาแอปพลิเคชันสำหรับ iOS และ Android โดยใช้ Flutter ซึ่งเป็นเครื่องมือจาก Google ที่ทำให้สามารถใช้โค้ดชุดเดียวในการสร้างแอปสำหรับทั้งสองระบบ เนื้อหาจะเริ่มตั้งแต่พื้นฐานการเขียนโปรแกรมด้วยภาษา Dart, การทำความเข้าใจเกี่ยวกับ Widget, การจัดการสถานะของแอป (State Management) และการเลือกใช้เครื่องมือเสริมจากภายนอก (Third-Party) ผู้เรียนจะได้ลงมือสร้างแอปพลิเคชันจริง 1 โปรเจคตลอดหลักสูตร เหมาะสำหรับผู้ที่ต้องการเริ่มต้นพัฒนา Mobile App, Software Engineer และนักเรียนนักศึกษาที่อยากเพิ่มทักษะ แต่ไม่เหมาะสำหรับผู้ที่ไม่มีพื้นฐานการเขียนโปรแกรมมาก่อน",
       "คอร์สเรียน UX Writing นี้ครอบคลุมเนื้อหาตั้งแต่พื้นฐานความสำคัญและกระบวนการทำงานของ UX Writer ไปจนถึงหลักการเขียนที่ดีโดยใช้เครื่องมืออย่าง Microcopy Canvas และการทำความเข้าใจใน UX Writing Patterns ต่างๆ ที่พบบ่อย นอกจากนี้ยังมีการนำหลักจิตวิทยามาประยุกต์ใช้ในการเขียนเพื่อสร้างประสบการณ์ที่ดีให้กับผู้ใช้งาน เช่น Framing Effect และ Social Proof พร้อมทั้งสอนวิธีการวัดผลความสำเร็จของงานเขียนและปิดท้ายด้วยแบบฝึกหัดและกรณีศึกษาเพื่อให้ผู้เรียนได้ลงมือปฏิบัติจริง",
       "คอร์ส OOP The Right Way - จาก Skooldio เป็นหลักสูตรออนไลน์ความยาวประมาณ 3–4 ชั่วโมง (ราคา 1,490 บาท) ที่ออกแบบมาเพื่อปูพื้นฐานการเขียนโค้ดเชิงวัตถุ (Object‑Oriented Programming) ให้คุณเข้าใจตั้งแต่เบื้องต้น—เช่น ความแตกต่างระหว่าง OOP กับการเขียนโปรแกรมแบบ procedural—จนถึงการออกแบบระบบที่ดี ดูแลง่าย และเหมาะกับงานในทีมขนาดใหญ่ โดยใช้ภาษา TypeScript ในการสาธิต (ไม่จำเป็นต้องมีพื้นฐาน TypeScript มาก่อน) ผู้เรียนจะได้รับทั้งความรู้เชิงทฤษฎี—เช่น Encapsulation, Abstraction, Polymorphism, Inheritance, SOLID principle—และก็ลงมือโค้ดจริงผ่าน use case ธุรกิจ ระบบอนุมัติจัดซื้อ รวมถึงเคสจาก ThoughtWorks ที่ช่วยให้เห็นภาพการใช้งานจริงชัดเจน จบคอร์สแล้วได้รับประกาศนียบัตร เหมาะกับนักพัฒนาที่มีพื้นฐานโปรแกรมมาแล้ว อยากเข้าใจแนวคิด OOP อย่างลึกซึ้งเพื่อใช้ในงานระดับองค์กร",
       "Customer Journey Mapping : สอนวิธีสร้าง Customer Journey Map (CJM) ซึ่งเป็นเครื่องมือสำคัญที่ช่วยให้เราเข้าใจประสบการณ์ของลูกค้าตั้งแต่ต้นจนจบ ตั้งแต่การเก็บข้อมูลเชิงลึกผ่านการสัมภาษณ์ลูกค้า ไปจนถึงการลงมือสร้าง CJM ด้วยเครื่องมือต่าง ๆ เช่น FigJam โดยเน้นการระบุปัญหา โอกาสในการพัฒนา และนำข้อมูลที่ได้ไปต่อยอดในการกำหนดแนวทางการพัฒนาผลิตภัณฑ์และบริการที่ตอบโจทย์ความต้องการของลูกค้าอย่างแท้จริง คอร์สนี้เหมาะสำหรับผู้ที่ทำงานด้านผลิตภัณฑ์, UX, การตลาด หรือใครก็ตามที่ต้องการทำความเข้าใจลูกค้าให้ลึกซึ้งยิ่งขึ้นเพื่อสร้างธุรกิจที่ประสบความสำเร็จ",
       "คอร์ส Statistics for Data Science ของ Skooldio เป็นคอร์สออนไลน์ระยะสั้น (2–3 ชั่วโมง) ที่ออกแบบสำหรับผู้มีพื้นฐานทางสถิติอยู่แล้ว มุ่งสอนหลักการสถิติที่จำเป็นในงาน Data Science อย่างเข้าใจจริงและพร้อมใช้งาน ไม่ว่าจะเป็นการประมาณค่าพารามิเตอร์ (Point & Bayesian Estimation, Confidence Interval), การทดสอบสมมติฐาน (Hypothesis Testing, P‑value, Effect Size) รวมถึงเทคนิคขั้นสูงอย่าง ANOVA, Average Treatment Effect (ATE) และ Goodness‑of‑Fit Test โดยเน้นให้ผู้เรียนสามารถ “อ่าน” และ “ตีความ” ข้อมูลอย่างถูกต้อง ไม่ถูกชักนำโดยการตีความเชิงสถิติที่ผิดพลาด เช่น การสับสนระหว่าง correlation และ causation หรือการใช้ค่าเฉลี่ยโดยไม่สนใจการกระจายของข้อมูล สนับสนุนด้วยแบบทดสอบในคอร์สและเมื่อเรียนจบก็จะได้ใบประกาศนียบัต",
       "คอร์สนี้แม่งโคตรได้! 🔥 ใครที่อยากเปลี่ยนวิธีคิดแบบเดิมๆ มาเป็นแนวคิดแบบนักนวัตกรรมสายสร้างสรรค์ ต้องโดน! สอนให้เข้าใจผู้ใช้แบบอินสุดใจ ไอเดียบรรเจิดแบบไม่มีกรอบ คิดไว ลองเร็ว ทดสอบจริง แล้วเอาไปใช้ได้แบบปังๆ ทั้งงาน สตาร์ทอัป หรือโปรเจกต์ส่วนตัว ไม่ใช่แค่ทฤษฎี แต่มาพร้อมเคสจริงในไทย สอนโดยตัวจี๊ดที่เคยอยู่ IDEO.org มาแล้ว คือมันเฟี้ยวจัดๆ เหมือนมีอาวุธลับติดตัวไว้เปลี่ยนโลกได้เลยอะ 🚀✨",
       "How to Become a Better Programmer: คือคอร์สที่ช่วยให้คุณเข้าใจการทำงานในโลกของ Software Development อย่างรอบด้าน ทั้งในแง่ของ System Design, การทำงานเป็นทีม, เครื่องมือสำคัญที่ใช้ในองค์กร เช่น Cache, Load Balancer, Version Control รวมถึง Soft Skill ที่จำเป็นอย่าง Communication และ Mindset การทำงาน โดยอิงจากประสบการณ์จริงของอดีตวิศวกรซอฟต์แวร์จาก Amazon เพื่อให้คุณไม่ต้องลองผิดลองถูกด้วยตัวเอง",
       "เจาะลึกเทคนิคการสัมภาษณ์ผู้ใช้งาน (User Interview) เพื่อให้ได้ insights ที่แม่นยำและนำไปใช้ทำงานได้จริง เริ่มตั้งแต่เบื้องต้น ผู้เรียนจะได้เรียนรู้การออกแบบกระบวนการสัมภาษณ์ ตั้งแต่การตั้งเป้าหมาย หาคนสัมภาษณ์ เลือกประเภทการถาม จนถึงการวิเคราะห์หลังสัมภาษณ์ พร้อมทั้งได้รับ template ฟรี สำหรับการจัดการข้อมูล และฝึกใช้กับ case studies จริง ตลอดระยะเวลาเรียนประมาณ 7–8 ชั่วโมง โดยสอนโดยคุณธนพร เบญจพลกุล ผู้เชี่ยวชาญด้าน UX เมื่อเรียนจบ คุณจะสามารถวางแผน สัมภาษณ์ และถอดข้อมูลเพื่อสร้าง Persona หรือ Customer Journey ได้อย่างเป็นระบบ",
       "คอร์สออนไลน์ Mastering Looker Studio: From Zero to Pro ถูกออกแบบมาเพื่อสอนให้คุณสามารถสร้าง Data Visualization และ Dashboard แบบมืออาชีพด้วย Looker Studio (ชื่อเดิม Google Data Studio) ได้ตั้งแต่ระดับพื้นฐานจนถึงขั้นสูง เนื้อหาครอบคลุมตั้งแต่การเชื่อมต่อข้อมูลจากแหล่งต่างๆ เช่น Google Sheets, Google Analytics และ BigQuery, การเลือกใช้และปรับแต่งกราฟหลากหลายรูปแบบ, การสร้างรีพอร์ตให้สวยงามและเป็น Interactive ผ่านการใช้ฟิลเตอร์และตัวควบคุม, ไปจนถึงเทคนิคขั้นสูงอย่างการใช้สูตรคำนวณ (Calculated Fields) และการรวมข้อมูลจากหลายแหล่ง (Data Blending) เพื่อให้ผู้เรียนไม่ว่าจะเป็นนักการตลาด เจ้าของธุรกิจ หรือผู้ที่ทำงานกับข้อมูล สามารถเปลี่ยนข้อมูลดิบที่ซับซ้อนให้กลายเป็นแดชบอร์ดที่เข้าใจง่ายและนำไปใช้ตัดสินใจทางธุรกิจได้อย่างมีประสิทธิภาพ",
       "คอร์ส Intro to Data Science: สร้างมูลค่าทางธุรกิจด้วยข้อมูล ของ Skooldio เป็นคอร์สเริ่มต้นสำหรับผู้ที่อยากเข้าใจวิธีนำข้อมูลมาใช้ในเชิงธุรกิจ โดยสอนตั้งแต่พื้นฐานว่าข้อมูลจะช่วยตัดสินใจและการสร้างผลิตภัณฑ์ได้อย่างไร ไปจนถึงภาพรวมของกระบวนการทำงานของ Data Scientist ผู้เรียนจะได้รู้จักทักษะที่จำเป็นสำหรับสายนี้ ทั้งการวิเคราะห์ข้อมูล การตีความเชิงสถิติ และการใช้งานเครื่องมือพื้นฐาน พร้อมตัวอย่างเคสจริงและสาธิตการใช้งาน เพื่อนำไปประยุกต์ใช้สร้างมูลค่าทางธุรกิจอย่างเป็นรูปธรรม",
       "คอร์สนี้สอนวิธีการเขียนภาษา SQL เพื่อนำไปใช้ในการวิเคราะห์ข้อมูลทางธุรกิจ คุณจะได้เรียนรู้ตั้งแต่พื้นฐานการทำงานของฐานข้อมูล วิธีดึงข้อมูลที่ต้องการ การแปลงข้อมูลให้พร้อมต่อการวิเคราะห์ จนไปถึงสรุปผลข้อมูล และการคำนวณทางสถิติเพื่อนำไปตอบคำถาม และประกอบการตัดสินใจทางธุรกิจ",
       "เป็นคอร์สสำหรับผู้เริ่มต้นที่ต้องการเรียนรู้การใช้งานโปรแกรม Microsoft Power BI ตั้งแต่พื้นฐาน เพื่อวิเคราะห์และนำเสนอข้อมูลผ่าน Dashboard ได้ด้วยตัวเอง เนื้อหาจะสอนตั้งแต่การเตรียมข้อมูล (Data Preparation), การทำความสะอาดข้อมูล (Data Cleansing), การสร้าง Data Model เพื่อเชื่อมความสัมพันธ์ของข้อมูล และพื้นฐานการเขียนภาษา DAX (Data Analysis Expression) สำหรับการคำนวณที่ซับซ้อนขึ้น",
       "OKRs หรือ Objectives and Key Results เป็นเครื่องมือเฟรมเวิร์คสำหรับตั้งเป้าหมายที่ถูกใช้อย่างโด่งดังโดยบริษัทยักษ์ใหญ่อย่าง Google หนึ่งในจุดเด่นของการใช้ OKRs ตั้งเป้าหมายคือ เราสามารถตั้งได้ทั้งในระดับองค์กร ทีม หรือรายบุคคลเลยทีเดียว"
    ]
})
print(df.head())

# Set up a Gemini client
genai_client = genai.Client(api_key=GEMINI_API_KEY)

# Set up a BigQuery client
service_account_info = json.load(open(KEYFILE))
credentials = service_account.Credentials.from_service_account_info(service_account_info)
bigquery_client = bigquery.Client(
    project=GCP_PROJECT_ID,
    credentials=credentials,
)

# Create the embeddings
df["embedding"] = df.text.map(lambda x: get_embedding(genai_client, text=x).values)
print(df.head())

# Store embeddings in BigQuery
load_data_to_bigquery(bigquery_client, df)

# Change your quesiton here
question = "อยากทำสาย Data Engineer ควรเรียนคอร์สอะไรดี?"

vec = get_embedding(genai_client, text=question).values

similar_texts = search_similar_texts(bigquery_client, vec)

# Create context by gathering results together
context = " / ".join([each for each in similar_texts])

prompt_with_context = f"""
Context:
{context}

Question:
{question}
"""

# response = ask_gemini(genai_client, prompt=prompt_with_context)
# print(response)
